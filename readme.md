# azure-sdk-generator

A CLI tool to generate TypeScript SDKs from public Microsoft OpenAPI specifications, such as the **Azure DevOps REST API specs** published in `MicrosoftDocs/vsts-rest-api-specs`.

The goal of this project is to provide a **reproducible, controlled, and reusable** way to generate strongly typed clients, without relying on legacy SDKs or copying code by hand.

> ‚ö†Ô∏è This project is **not affiliated with, endorsed by, or supported by Microsoft**.

---

## ‚ú® Features

- SDK generation from official OpenAPI specifications
- Automatic discovery of available APIs and versions
- Support for multiple versions of the same API
- Generation of npm-ready packages
- Optional local caching of OpenAPI specs
- Cross-platform CLI (Node.js 18+)

---

## üì¶ Installation (CLI)

```bash
npm install -D @valdepeace/az-sdk-gen
```

Or run it directly without installing:

```bash
npx @valdepeace/az-sdk-gen --help
```

---

## üöÄ Basic Usage

### List available APIs

```bash
npx @valdepeace/az-sdk-gen list
```

### List available versions for an API

```bash
npx @valdepeace/az-sdk-gen list --api graph
```

### Resolve which OpenAPI spec will be used

```bash
npx @valdepeace/az-sdk-gen resolve --api graph --api-version 7.1
```

Expected output:

```
graph.json
https://raw.githubusercontent.com/MicrosoftDocs/vsts-rest-api-specs/master/specification/graph/7.1/graph.json
```

---

## üõ†Ô∏è Generate an SDK

```bash
npx @valdepeace/az-sdk-gen generate \
  --api graph \
  --api-version 7.1 \
  --out packages/generated \
  --scope @valdepeace
```

This will generate an npm package at:

```
packages/generated/azure-devops-graph-7.1/
```

---

## üìÅ Generated SDK Structure

Each generated SDK is an **independent npm package**, containing:

* `package.json`
* `tsconfig.json`
* `README.md`
* TypeScript source code generated by `openapi-generator`
* Compiled output in `dist/` with typings

Example:

```
azure-devops-graph-7.1/
  package.json
  tsconfig.json
  README.md
  index.ts
  dist/
```

To build the generated SDK:

```bash
cd packages/generated/azure-devops-graph-7.1
pnpm install
pnpm build
```

---

## üß† Project Philosophy

This project intentionally does **not**:

* Provide business logic
* Handle authentication
* Abstract Azure DevOps behavior
* Modify or ‚Äúfix‚Äù official OpenAPI specs

The CLI focuses strictly on:

> **discover ‚Üí generate ‚Üí package**

This approach keeps the tool simple, predictable, and easy to maintain as upstream specifications evolve.

---

## üß© Technologies Used

* Node.js 18+
* TypeScript
* `https://github.com/OpenAPITools/openapi-generator` 
* GitHub REST API (Contents API)

---

## ‚ö†Ô∏è Disclaimer

The generated SDKs are based directly on public Microsoft OpenAPI specifications.
SDK quality, completeness, and stability depend on those upstream specifications.

---

## üìÑ License

MIT

## üìò Examples

The generated SDKs are plain TypeScript clients created using
`openapi-generator` with the `typescript-fetch` generator.

They expose API classes and models that can be instantiated and used directly.

> The exact API names depend on the OpenAPI specification and may vary slightly
> between versions.

---

### Example: Using a generated Azure DevOps SDK in Node.js

Install the generated SDK package:

```bash
npm install @valdepeace/azure-devops-graph-7.1
```

Import the API client and create a configuration:

```ts
import { Configuration, GraphApi } from "@valdepeace/azure-devops-graph-7.1";

// Azure DevOps organization URL
const basePath = " `https://dev.azure.com/your-org` ";

// Personal Access Token (PAT)
const pat = process.env.AZDO_PAT as string;

// Basic auth with PAT (username is empty)
const authHeader = {
  Authorization: "Basic " + Buffer.from(`:${pat}`).toString("base64")
};

const config = new Configuration({
  basePath,
  headers: authHeader
});

const graphApi = new GraphApi(config);
```

Call an API method:

```ts
const users = await graphApi.graphUsersList();
console.log(users);
```
Example: Custom fetch implementation (advanced)
The generated SDK allows injecting a custom fetch implementation,
for example to add logging, retries, or custom headers.

```ts
Copiar c√≥digo
import { Configuration, GraphApi } from "@valdepeace/azure-devops-graph-7.1";

const customFetch: typeof fetch = async (input, init) => {
  console.log("Request:", input);
  return fetch(input, init);
};

const config = new Configuration({
  basePath: " `https://dev.azure.com/your-org` ",
  fetchApi: customFetch
});

const api = new GraphApi(config);
```
Example: Regenerating the SDK when specs change
If Microsoft updates the OpenAPI specs, simply regenerate the SDK:

```bash
npx @valdepeace/az-sdk-gen generate \
  --api graph \
  --api-version 7.1 \
  --out packages/generated \
  --scope @valdepeace
  ```
Then rebuild the package:

```bash
cd packages/generated/azure-devops-graph-7.1
pnpm install
pnpm build
```

No manual code changes are required.

**Notes on authentication**
Authentication is **not handled by this project**.

Consumers are responsible for:

* Providing the correct basePath
* Supplying authentication headers (PAT, Bearer token, etc.)

This design keeps the generated SDKs flexible and environment-agnostic.


Despu√©s de ejemplos, las dos mejoras naturales son:

1) **Exports m√°s limpios** en el SDK generado  
   (re-exportar APIs principales desde `index.ts`)
2) Un **wrapper opcional** (fuera del generator) para uso m√°s c√≥modo

Pero eso ya es evoluci√≥n, no requisito.

Cuando quieras, seguimos.
